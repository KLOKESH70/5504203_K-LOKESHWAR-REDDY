#include <stdio.h>

#define MAXN 100000

int main(){
    int Q;
    scanf("%d", &Q);
    
    int heap[MAXN+5];
    int heapSize =0;
    
    #define SWAP(a,b){int tmp=a; a=b; b=tmp;}
    
     for (int q=0; q<Q; q++){
        int type, val;
        scanf("%d", &type);
        
        if (type==1){
            scanf("%d", &val);
            heapSize++;
            heap[heapSize]=val;
            int idx =heapSize;
            
            while (idx>1  && heap[idx] < heap[idx/2]){
                SWAP(heap[idx], heap[idx/2]);
                idx/=2;
            }
        }
        else if (type ==2){
            scanf("%d", &val);
            int idx =-1;
            for (int i=1; i<= heapSize; i++){
                if (heap[i]==val){
                    idx=i;
                    break;
                }
            }
            if (idx != -1){
                heap[idx] =heap[heapSize];
                heapSize--;
                while (idx>1 && heap[idx] < heap[idx/2]){
                    SWAP(heap[idx], heap[idx/2]);
                    idx/=2;
                }
                while (1){
                    int smallest = idx;
                    int left= idx*2, right = idx*2+1;
                    if (left <= heapSize && heap[left]< heap[smallest]) smallest= left;
                    if (right <= heapSize && heap[right]< heap[smallest]) smallest= right;
                    if (smallest != idx){
                        SWAP(heap[idx], heap[smallest]);
                        idx = smallest;
                    }else break;
                }
            }
        }
        else if (type ==3){
            printf("%d\n", heap[1]);
        }
     }
     return 0;
}